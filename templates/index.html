<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login-Page</title>
    <link rel="stylesheet" href="../static/src/style.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@48,400,0,0" />
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>
<body>
    <div class="flash-container">
        {% with messages = get_flashed_messages() %}
            {% if messages %}
                <div class="flash-message" id="alert-message">
                    {{ messages[0] }}
                    <button type="button" class="close" onclick="closeAlert()">×</button>
                </div>
            {% endif %}
        {% endwith %}
    </div>
    <form action="/login" method="POST">
    <div class="login-page-container">
        <div class="login-page">
            <div class="login-page-logo">
                <img src="../static/images/tec-logo.png" alt="logo">
            </div>
            <div class="login-page-header">
                <div>CreditSense: Evaluación Crediticia</div>
            </div>
            <div class="login-page-form">
                <div class="form-item">
                    <input id="username" type="text" name="username" required>
                    <span class="form-item-icon material-symbols-outlined">person</span>
                    <div class="label">Nombre de Usuario</div>
                </div>
                <div class="form-item">
                    <input id="password" type="password" name="password" required>
                    <span class="form-item-icon material-symbols-outlined">lock</span>
                    <div class="label">Contraseña</div>
                </div>
                <div class="form-item-other">
                    <div class="checkbox">
                        <input type="checkbox" id="remember_me_checkbox">
                        <label for="remember_me_checkbox">Recuérdame</label>
                    </div>
                    <a href="#">¿Olvidó su contraseña?</a>
                </div>
                <button id="join" type="form">Ingresar</button>
            </div>
            <div class="login-page-footer" style="display: none;">
                ¿No tiene una cuenta? <a href="#">Unete ahora</a>
            </div>
            <div class="login-page-social" style="display: none;">
                <div>Unite usando:</div>
                <div class="login-page-social-btn">
                    <a class="facebook-logo" href="#">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-facebook" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                            <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                            <path d="M7 10v4h3v7h4v-7h3l1 -4h-4v-2a1 1 0 0 1 1 -1h3v-4h-3a5 5 0 0 0 -5 5v2h-3"></path>
                        </svg>
                    </a>
                    <a class="instagram-logo" href="#">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-instagram" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                            <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                            <path d="M4 4m0 4a4 4 0 0 1 4 -4h8a4 4 0 0 1 4 4v8a4 4 0 0 1 -4 4h-8a4 4 0 0 1 -4 -4z"></path>
                            <path d="M12 12m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0"></path>
                            <path d="M16.5 7.5l0 0"></path>
                        </svg>
                    </a>
                    <a class="twitter-logo" href="#">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                            <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                            <path d="M22 4.01c-1 .49 -1.98 .689 -3 .99c-1.121 -1.265 -2.783 -1.335 -4.38 -.737s-2.643 2.06 -2.62 3.737v1c-3.245 .083 -6.135 -1.395 -8 -4c0 0 -4.182 7.433 4 11c-1.872 1.247 -3.739 2.088 -6 2c3.308 1.803 6.913 2.423 10.034 1.517c3.58 -1.04 6.522 -3.723 7.651 -7.742a13.84 13.84 0 0 0 .497 -3.753c0 -.249 1.51 -2.772 1.818 -4.013z"></path>
                        </svg>
                    </a>
                </div>
            </div>
        </div>
    </div>
    </form>
</body>
<script>
    // Obtener el mensaje de la alerta
    const message = '{{ get_flashed_messages(with_categories=true) }}';
    
    // Convertir el mensaje a un objeto JSON
    const json_message = JSON.parse(message.replace(/&quot;/g, '"'));

    // Recorrer cada mensaje
    json_message.forEach(msg => {
        // Mostrar la alerta con SweetAlert2
        Swal.fire({
            icon: msg[0] === 'success' ? 'success' : 'error',
            title: msg[0] === 'success' ? 'Acceso Autorizado' : 'Usuario o Contraseña inválidos',
            text: msg[1],
            showCloseButton: true
        });
    });

    function closeAlert() {
        var alert = document.getElementById("alert-message");
        alert.style.display = "none";
    }
</script>
</html>
